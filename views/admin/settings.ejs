<!-- Admin Settings Page - Refactored Version -->
<!-- Using Design System -->


<div class="page-container">
    <div class="admin-two-col">
        <!-- Bal oldal: Form -->
        <div>
            <form id="general-form">
                <div class="card--data">
                    <h3 class="section-title">
                        ‚öôÔ∏è Alapvet≈ë Be√°ll√≠t√°sok
                    </h3>
                    
                    <div class="form__group">
                        <label class="form__label" for="general.site_name">Oldal Neve <span class="required-field-asterisk">*</span></label>
                        <input type="text" 
                               name="general.site_name" 
                               id="general.site_name"
                               class="form__control"
                               value="<%= flatSettings['general.site_name'] || '' %>"
                               placeholder="pl. Koncert24.hu"
                               required>
                        <small class="form__hint">A weboldal megjelen√≠tett neve (b√∂ng√©sz≈ë c√≠msorban, emailekben)</small>
                    </div>

                    <div class="form__group">
                        <label class="form__label" for="general.domain">Domain <span class="required-field-asterisk">*</span></label>
                        <input type="text" 
                               name="general.domain" 
                               id="general.domain"
                               class="form__control"
                               value="<%= flatSettings['general.domain'] || '' %>"
                               placeholder="https://koncert24.hu"
                               required>
                        <small class="form__hint">Teljes URL protokollal egy√ºtt (https://...)</small>
                    </div>

                    <div class="form__group">
                        <label class="form__label" for="general.locale">Nyelvi Be√°ll√≠t√°s (Locale)</label>
                        <select name="general.locale" id="general.locale" class="form__control">
                            <option value="hu_HU" <%= flatSettings['general.locale'] === 'hu_HU' || !flatSettings['general.locale'] ? 'selected' : '' %>>üá≠üá∫ Magyar (hu_HU)</option>
                            <option value="en_US" <%= flatSettings['general.locale'] === 'en_US' ? 'selected' : '' %>>üá∫üá∏ English (en_US)</option>
                            <option value="en_GB" <%= flatSettings['general.locale'] === 'en_GB' ? 'selected' : '' %>>üá¨üáß English UK (en_GB)</option>
                        </select>
                        <small class="form__hint">D√°tumok, sz√°mform√°tumok megjelen√≠t√©si nyelve</small>
                    </div>

                    <div class="btn__group btn__group--equal mb-4">
                        <button type="button" class="btn btn--primary" onclick="saveSection('general')">
                            üíæ Ment√©s
                        </button>
                    </div>
                </div>
            </form>
        </div>

        <!-- Jobb oldal: Info Panels -->
        <div>
            <!-- √Åltal√°nos inform√°ci√≥ -->
            <div class="card--data">
                <h3 class="section-title">
                    ‚ÑπÔ∏è Alapbe√°ll√≠t√°sok
                </h3>
                
                <div class="settings-card__info-content">
                    <p>
                        <strong>üåê Oldal Neve:</strong><br>
                        Ez jelenik meg a b√∂ng√©sz≈ë c√≠msor√°ban, emailekben √©s az SEO title tagekben alap√©rtelmezettk√©nt.
                    </p>
                    
                    <p>
                        <strong>üîó Domain:</strong><br>
                        A weboldal teljes URL c√≠me. Fontos, hogy a protokollt (https://) is tartalmazza!
                    </p>
                    
                    <p>
                        <strong>üåç Locale:</strong><br>
                        Meghat√°rozza a d√°tumok, sz√°mok √©s egy√©b region√°lis adatok megjelen√≠t√©si form√°tum√°t.
                    </p>
                </div>
            </div>

            <!-- Tippek -->
            <div class="card--data settings-card-spacing">
                <h3 class="section-title">
                    üí° Tippek
                </h3>
                
                <div class="settings-card__info-content">
                    <p>
                        <strong>‚úÖ Domain ellen≈ërz√©s:</strong><br>
                        Gy≈ëz≈ëdj meg r√≥la, hogy a domain HTTPS protokollt haszn√°l √©s nincs v√©g√©n perjel (/).
                    </p>
                    
                    <p>
                        <strong>üîÑ V√°ltoz√°sok √©rv√©nyes√≠t√©se:</strong><br>
                        A ment√©s ut√°n egyes v√°ltoz√°sok csak √∫jrat√∂lt√©s ut√°n lesznek l√°that√≥k.
                    </p>
                    
                    <p>
                        <strong>üìß Email hivatkoz√°sok:</strong><br>
                        A domain be√°ll√≠t√°s befoly√°solja az emailekben l√©v≈ë linkeket is.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
const csrfToken = '<%= csrfToken %>';

async function saveSection(section) {
    const form = document.getElementById(`${section}-form`);
    const formData = new FormData(form);
    
    const settingsObj = {};
    for (const [key, value] of formData.entries()) {
        settingsObj[key] = value;
    }
    
    try {
        const response = await fetch(`/admin/settings/section/${section}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRF-Token': csrfToken
            },
            body: JSON.stringify({ settings: settingsObj })
        });
        
        const data = await response.json();
        
        if (data.success) {
            showAlert('success', `‚úÖ ${data.message || 'Sikeresen mentve!'}`);
        } else {
            showAlert('error', `‚ùå ${data.message || 'Hiba t√∂rt√©nt a ment√©s sor√°n'}`);
        }
    } catch (error) {
        showAlert('error', `‚ùå H√°l√≥zati hiba: ${error.message}`);
    }
}

// ‚úÖ DESIGN SYSTEM: Uses global showAlert() from admin-alerts.js
// No local definition needed - automatically available on all admin pages
</script>
