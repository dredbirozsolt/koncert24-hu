
<section class="section">
    <div class="max-w-2xl mx-auto">
        <div class="card">
            <div class="card__header">
                <h2 class="card__title">‚úâÔ∏è Email c√≠m m√≥dos√≠t√°sa</h2>
            </div>

            <div class="card__body">
                <% if (typeof error !== 'undefined' && error) { %>
                    <div class="alert alert--error mb-6">
                        <div class="alert__icon">‚ö†Ô∏è</div>
                        <div class="alert__content">
                            <p class="alert__message">
                                <% if (error === 'invalid_password') { %>
                                    Hib√°s jelsz√≥. K√©rlek, pr√≥b√°ld √∫jra.
                                <% } else if (error === 'email_taken') { %>
                                    Ez az email c√≠m m√°r haszn√°latban van.
                                <% } else if (error === 'same_email') { %>
                                    Az √∫j email c√≠m nem lehet ugyanaz, mint a jelenlegi.
                                <% } else if (error === 'validation') { %>
                                    K√©rlek, adj meg √©rv√©nyes email c√≠met.
                                <% } else { %>
                                    <%= error %>
                                <% } %>
                            </p>
                        </div>
                    </div>
                <% } %>

                <% if (typeof success !== 'undefined' && success) { %>
                    <div class="alert alert--success mb-6">
                        <div class="alert__icon">‚úÖ</div>
                        <div class="alert__content">
                            <p class="alert__message">
                                Meger≈ës√≠t≈ë emaileket k√ºldt√ºnk mindk√©t c√≠mre! K√©rlek, ellen≈ërizd a be√©rkez≈ë levelek mapp√°j√°t √©s a spam mapp√°t is.
                            </p>
                        </div>
                    </div>
                <% } %>

                <div class="alert alert--info mb-6">
                    <div class="alert__icon">üîê</div>
                    <div class="alert__content">
                        <p class="alert__message">
                            <strong>Biztons√°gi inform√°ci√≥:</strong> Az email c√≠m m√≥dos√≠t√°sa biztons√°gi okokb√≥l meger≈ës√≠t√©st ig√©nyel. Meger≈ës√≠t≈ë linkeket k√ºld√ºnk mindk√©t email c√≠mre (jelenlegi √©s √∫j) a biztons√°g √©rdek√©ben.
                        </p>
                    </div>
                </div>

                <form method="POST" action="<%= basePath %>auth/profile/change-email" x-data="emailForm()">
                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                    
                    <div class="form__group">
                        <label for="currentEmail" class="form__label">
                            ‚úâÔ∏è Jelenlegi email c√≠m
                        </label>
                        <input 
                            type="email" 
                            id="currentEmail" 
                            class="form__input"
                            value="<%= user.email %>"
                            disabled
                        />
                    </div>

                    <div class="form__group">
                        <label for="newEmail" class="form__label">
                            ‚úâÔ∏è √öj email c√≠m *
                        </label>
                        <input 
                            type="email" 
                            id="newEmail" 
                            name="newEmail" 
                            class="form__input"
                            required
                            autocomplete="email"
                            placeholder="uj.email@example.com"
                        />
                        <span class="form__help">Add meg az √∫j email c√≠med, amelyre m√≥dos√≠tani szeretn√©l</span>
                    </div>

                    <div class="form__group">
                        <label for="password" class="form__label">
                            üîí Jelenlegi jelsz√≥ *
                        </label>
                        <div class="form__input-group form__input-group--icon-right">
                            <input 
                                x-bind:type="showPassword ? 'text' : 'password'"
                                id="password" 
                                name="password" 
                                class="form__input"
                                required
                                autocomplete="current-password"
                                placeholder="Biztons√°gi ellen≈ërz√©s"
                            />
                            <button 
                                type="button" 
                                class="form__input-icon-right btn-unstyled text-primary-600 text-sm"
                                x-on:click="showPassword = !showPassword"
                                x-text="showPassword ? 'Elrejt' : 'Mutat'"
                                tabindex="-1"
                            ></button>
                        </div>
                        <span class="form__help">Biztons√°gi okokb√≥l meg kell adnod a jelenlegi jelszavad</span>
                    </div>

                    <div class="flex gap-3 mt-6">
                        <button type="submit" class="btn btn--primary flex-1">
                            üì§ Meger≈ës√≠t≈ë emailek k√ºld√©se
                        </button>
                        <a href="<%= basePath %>auth/profile/edit" class="btn btn--outline flex-1">
                            ‚Üê Vissza
                        </a>
                    </div>
                </form>
            </div>
        </div>

        <div class="card mt-6">
            <div class="card__header">
                <h3 class="card__title">‚ÑπÔ∏è M√≥dos√≠t√°si folyamat</h3>
            </div>
            <div class="card__body">
                <ol class="list-decimal ml-6 space-y-3">
                    <li>
                        <strong>√öj email c√≠m megad√°sa</strong> √©s jelsz√≥ meger≈ës√≠t√©s
                    </li>
                    <li>
                        Meger≈ës√≠t≈ë link k√ºld√©se a <strong>jelenlegi</strong> email c√≠medre - biztons√°gi ellen≈ërz√©s
                    </li>
                    <li>
                        Meger≈ës√≠t≈ë link k√ºld√©se az <strong>√∫j</strong> email c√≠medre - l√©tez≈ë c√≠m ellen≈ërz√©s
                    </li>
                    <li>
                        Mindk√©t linkre kattint√°s ut√°n az email c√≠med automatikusan m√≥dosul
                    </li>
                    <li>
                        √ârtes√≠t≈ë email mindk√©t c√≠mre a sikeres m√≥dos√≠t√°sr√≥l
                    </li>
                </ol>
            </div>
        </div>
    </div>
</section>

<script>
function emailForm() {
    return {
        showPassword: false
    };
}
</script>
