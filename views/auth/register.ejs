<!-- Auth register with Design System -->

<section class="section">
    <div class="max-w-md mx-auto">
        <div class="card">
            <div class="card__header text-center">
                <h1 class="card__title text-2xl">Regisztr√°ci√≥</h1>
                <p class="text-sm text-gray-600 mt-2">Hozz l√©tre √∫j fi√≥kot</p>
            </div>

            <div class="card__body">
                <% if (error) { %>
                    <div class="alert alert--error mb-6">
                        <div class="alert__icon">‚ùå</div>
                        <div class="alert__content">
                            <% if (error === 'validation' && validationErrors && validationErrors.length > 0) { %>
                                <p class="alert__message">
                                    <strong>K√©rj√ºk, jav√≠tsd a k√∂vetkez≈ë hib√°kat:</strong>
                                </p>
                                <ul class="list-disc ml-5 mt-2 space-y-1">
                                    <% validationErrors.forEach(function(err) { %>
                                        <li class="text-sm"><%= err.msg %></li>
                                    <% }); %>
                                </ul>
                            <% } else { %>
                                <p class="alert__message">
                                    <% if (error === 'validation') { %>
                                        K√©rj√ºk, t√∂ltsd ki helyesen az √∂sszes mez≈ët!
                                    <% } else if (error === 'exists') { %>
                                        Ez az email c√≠m m√°r regisztr√°lva van!
                                    <% } else if (error === 'server') { %>
                                        Szerver hiba t√∂rt√©nt. K√©rj√ºk, pr√≥b√°ld √∫jra k√©s≈ëbb!
                                    <% } else { %>
                                        Regisztr√°ci√≥s hiba!
                                    <% } %>
                                </p>
                            <% } %>
                        </div>
                    </div>
                <% } %>

                <form method="POST" action="<%= basePath %>auth/register">
                    <!-- üõ°Ô∏è CSRF Protection -->
                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                    
                    <!-- Honeypot fields - hidden from users, visible to bots -->
                    <input type="text" name="website" style="position:absolute;left:-9999px;width:1px;height:1px" tabindex="-1" autocomplete="off">
                    <input type="text" name="url" style="position:absolute;left:-9999px;width:1px;height:1px" tabindex="-1" autocomplete="off">
                    <input type="text" name="homepage" style="position:absolute;left:-9999px;width:1px;height:1px" tabindex="-1" autocomplete="off">
                    <input type="text" name="company_name" style="position:absolute;left:-9999px;width:1px;height:1px" tabindex="-1" autocomplete="off">
                    <input type="text" name="phone_number" style="position:absolute;left:-9999px;width:1px;height:1px" tabindex="-1" autocomplete="off">
                    
                    <div class="form__group">
                        <label for="name" class="form__label">üë§ Teljes n√©v</label>
                        <input 
                            type="text" 
                            id="name" 
                            name="name" 
                            class="form__input"
                            required 
                            autofocus 
                            autocomplete="name"
                            placeholder="Teljes n√©v"
                            value="<%= formData.name || '' %>"
                        >
                    </div>

                    <div class="form__group">
                        <label for="email" class="form__label">üìß Email c√≠m</label>
                        <input 
                            type="email" 
                            id="email" 
                            name="email" 
                            class="form__input"
                            required 
                            autocomplete="email"
                            placeholder="pelda@email.com"
                            value="<%= formData.email || '' %>"
                        >
                    </div>

                    <div class="form__group">
                        <label for="phone" class="form__label">üì± Telefonsz√°m</label>
                        <input 
                            type="tel" 
                            id="phone" 
                            name="phone" 
                            class="form__input"
                            required 
                            autocomplete="tel"
                            placeholder="+36 30 123 4567"
                            value="<%= formData.phone || '' %>"
                        >
                    </div>

                    <div class="form__group">
                        <label for="password" class="form__label">üîë Jelsz√≥</label>
                        <input 
                            type="password" 
                            id="password" 
                            name="password" 
                            class="form__input"
                            required 
                            autocomplete="new-password"
                            placeholder="Minimum 8 karakter, kis- √©s nagybet≈±, sz√°m"
                            minlength="8"
                        >
                        <span class="form__help">Legal√°bb 8 karakter, tartalmazzon kis- √©s nagybet≈±t, valamint sz√°mot</span>
                    </div>

                    <div class="form__group">
                        <label for="passwordConfirm" class="form__label">üîí Jelsz√≥ meger≈ës√≠t√©se</label>
                        <input 
                            type="password" 
                            id="passwordConfirm" 
                            name="passwordConfirm" 
                            class="form__input"
                            required 
                            autocomplete="new-password"
                            placeholder="Jelsz√≥ √∫jra"
                            minlength="8"
                        >
                    </div>

                    <div class="form__group">
                        <label class="form__label">üë• Ki √ñn?</label>
                        <div class="space-y-4">
                            <label class="flex items-center gap-4 p-4 border border-gray-300 rounded-lg cursor-pointer hover:border-primary transition-colors">
                                <input type="radio" id="role-client" name="role" value="client" required 
                                       <%= (formData.role === 'client' || !formData.role) ? 'checked' : '' %>>
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="text-xl">üéâ</span>
                                        <span class="font-semibold">Megrendel≈ë, szervez≈ë</span>
                                    </div>
                                    <p class="text-sm text-gray-600">Esem√©nyeket szervezek</p>
                                </div>
                            </label>
                            <label class="flex items-center gap-4 p-4 border border-gray-300 rounded-lg cursor-pointer hover:border-primary transition-colors">
                                <input type="radio" id="role-performer" name="role" value="performer" required
                                       <%= formData.role === 'performer' ? 'checked' : '' %>>
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="text-xl">üé§</span>
                                        <span class="font-semibold">El≈ëad√≥, manager</span>
                                    </div>
                                    <p class="text-sm text-gray-600">El≈ëad√≥/m≈±v√©sz vagyok</p>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="form__group">
                        <label class="flex items-start gap-3 cursor-pointer">
                            <input type="checkbox" id="terms" name="terms" class="mt-1" required>
                            <span class="text-sm">
                                Elfogadom a <a href="<%= basePath %>info/adatkezeles" target="_blank" class="text-primary hover:underline">felhaszn√°l√°si felt√©teleket √©s az adatkezel√©si t√°j√©koztat√≥t</a>.
                            </span>
                        </label>
                    </div>

                    <button type="submit" class="btn btn--primary w-full">
                        Regisztr√°ci√≥
                    </button>
                </form>
            </div>

            <div class="card__footer border-t text-center">
                <p class="text-sm text-gray-600">
                    M√°r van fi√≥kod? 
                    <a href="<%= basePath %>auth/login" class="text-primary hover:underline font-semibold">
                        Jelentkezz be itt!
                    </a>
                </p>
            </div>
        </div>
    </div>
</section>

<script>
// Password confirmation validation
document.getElementById('passwordConfirm').addEventListener('input', function() {
    const password = document.getElementById('password').value;
    const confirm = this.value;
    
    if (confirm && password !== confirm) {
        this.setCustomValidity('A jelszavak nem egyeznek');
    } else {
        this.setCustomValidity('');
    }
});

document.getElementById('password').addEventListener('input', function() {
    const confirm = document.getElementById('passwordConfirm');
    if (confirm.value) {
        confirm.dispatchEvent(new Event('input'));
    }
});
</script>