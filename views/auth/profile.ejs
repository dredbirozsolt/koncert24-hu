

<section class="section">
    <div class="max-w-2xl mx-auto">
        <% if (typeof error !== 'undefined' && error) { %>
            <div class="alert alert--error mb-6">
                <div class="alert__icon">‚ö†Ô∏è</div>
                <div class="alert__content">
                    <h3 class="alert__title">Hiba t√∂rt√©nt</h3>
                    <p class="alert__message">
                        <% if (error === 'delete') { %>
                            Hiba t√∂rt√©nt a fi√≥k t√∂rl√©se sor√°n. K√©rj√ºk, pr√≥b√°ld √∫jra k√©s≈ëbb.
                        <% } else if (error === 'notfound') { %>
                            A felhaszn√°l√≥i fi√≥k nem tal√°lhat√≥.
                        <% } else if (error === 'verification') { %>
                            Hiba t√∂rt√©nt a meger≈ës√≠t≈ë email k√ºld√©se sor√°n. K√©rj√ºk, pr√≥b√°ld √∫jra k√©s≈ëbb.
                        <% } else { %>
                            Ismeretlen hiba t√∂rt√©nt.
                        <% } %>
                    </p>
                </div>
            </div>
        <% } %>
        
        <% if (typeof success !== 'undefined' && success) { %>
            <div class="alert alert--success mb-6">
                <div class="alert__icon">‚úÖ</div>
                <div class="alert__content">
                    <h3 class="alert__title">
                        <% if (success === 'basic_info_updated') { %>
                            Adatok sikeresen mentve!
                        <% } else if (success === 'password_changed') { %>
                            Jelsz√≥ sikeresen m√≥dos√≠tva!
                        <% } else if (success && success.includes('Email c√≠me sikeresen meger≈ës√≠tve')) { %>
                            Email meger≈ës√≠t√©s sikeres
                        <% } else if (success === 'verification_sent') { %>
                            Meger≈ës√≠t≈ë email √∫jra elk√ºldve!
                        <% } else { %>
                            Sikeres m≈±velet
                        <% } %>
                    </h3>
                    <p class="alert__message">
                        <% if (success === 'basic_info_updated') { %>
                            A n√©v √©s telefonsz√°m sikeresen friss√≠tve lett.
                        <% } else if (success === 'password_changed') { %>
                            A jelszavad sikeresen m√≥dos√≠t√°sra ker√ºlt. Email √©rtes√≠t√©st k√ºldt√ºnk a v√°ltoz√°sr√≥l.
                        <% } else if (success === 'verification_sent') { %>
                            Meger≈ës√≠t≈ë email √∫jra elk√ºldve! K√©rj√ºk, ellen≈ërizd a be√©rkez≈ë levelek mapp√°j√°t √©s a spam mapp√°t is.
                        <% } else if (success === 'already_verified') { %>
                            Az email c√≠med m√°r meger≈ës√≠tve van.
                        <% } else if (success && success.includes('Email c√≠me sikeresen meger≈ës√≠tve')) { %>
                            Az email c√≠m meger≈ës√≠t√©se sikeres.
                        <% } else { %>
                            M≈±velet sikeresen v√©grehajtva.
                        <% } %>
                    </p>
                </div>
            </div>
        <% } %>
        
        <!-- Email Verification Banner -->
        <% if (!user.emailVerified) { %>
            <div class="alert alert--warning mb-6">
                <div class="alert__icon">‚ö†Ô∏è</div>
                <div class="alert__content">
                    <h3 class="alert__title">Email c√≠m meger≈ës√≠t√©se sz√ºks√©ges</h3>
                    <p class="alert__message mb-4">
                        Az email c√≠med m√©g nincs meger≈ës√≠tve. K√©rlek er≈ës√≠tsd meg, hogy teljes hozz√°f√©r√©st kapj az √∂sszes funkci√≥hoz (pl. √°rkalkul√°ci√≥, aj√°nlatk√©r√©s).
                    </p>
                    <div class="text-center">
                        <form method="POST" action="<%= basePath %>auth/resend-verification" class="inline">
                            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                            <button type="submit" class="btn btn--primary btn--sm">
                                üìß Meger≈ës√≠t≈ë email √∫jrak√ºld√©se
                            </button>
                        </form>
                    </div>
                    <p class="text-xs text-gray-600 mt-3 text-center">
                        üí° Ha nem tal√°lod az emailt, n√©zd meg a spam/lev√©lszem√©t mapp√°t is!
                    </p>
                </div>
            </div>
        <% } %>
        
        <div class="card mb-6">
            <div class="card__header">
                <h2 class="card__title">üìã Szem√©lyes adatok</h2>
            </div>
            <div class="card__body">
                <div class="space-y-4">
                    <div class="flex items-start gap-4 p-4 bg-gray-50 rounded-lg">
                        <span class="text-sm font-semibold text-gray-700 min-w-[150px]">üë§ N√©v:</span>
                        <span class="text-base text-gray-900"><%= user.name %></span>
                    </div>

                    <div class="flex items-start gap-4 p-4 bg-gray-50 rounded-lg">
                        <span class="text-sm font-semibold text-gray-700 min-w-[150px]">üìß Email c√≠m:</span>
                        <span class="text-base text-gray-900"><%= user.email %></span>
                    </div>

                    <div class="flex items-start gap-4 p-4 bg-gray-50 rounded-lg">
                        <span class="text-sm font-semibold text-gray-700 min-w-[150px]">üì± Telefonsz√°m:</span>
                        <span class="text-base text-gray-900"><%= user.phone %></span>
                    </div>

                    <div class="flex items-start gap-4 p-4 bg-gray-50 rounded-lg">
                        <span class="text-sm font-semibold text-gray-700 min-w-[150px]">üë• Szerepk√∂r:</span>
                        <span class="text-base text-gray-900">
                            <% if (user.role === 'admin') { %>
                                üëë Adminisztr√°tor
                            <% } else if (user.role === 'sales') { %>
                                üíº √ârt√©kes√≠t≈ë
                            <% } else if (user.role === 'performer') { %>
                                üé§ El≈ëad√≥, manager
                            <% } else if (user.role === 'client') { %>
                                üë§ Megrendel≈ë, szervez≈ë
                            <% } else { %>
                                <%= user.role %>
                            <% } %>
                        </span>
                    </div>

                    <div class="flex items-start gap-4 p-4 bg-gray-50 rounded-lg">
                        <span class="text-sm font-semibold text-gray-700 min-w-[150px]">üìÖ Regisztr√°ci√≥ d√°tuma:</span>
                        <span class="text-base text-gray-900">
                            <%= new Date(user.createdAt).toLocaleDateString('hu-HU', { 
                                year: 'numeric', 
                                month: 'long', 
                                day: 'numeric' 
                            }) %>
                        </span>
                    </div>

                    <% if (user.lastLoginAt) { %>
                        <div class="flex items-start gap-4 p-4 bg-gray-50 rounded-lg">
                            <span class="text-sm font-semibold text-gray-700 min-w-[150px]">üïê Utols√≥ bel√©p√©s:</span>
                            <span class="text-base text-gray-900">
                                <%= new Date(user.lastLoginAt).toLocaleDateString('hu-HU', { 
                                    year: 'numeric', 
                                    month: 'long', 
                                    day: 'numeric',
                                    hour: '2-digit',
                                    minute: '2-digit'
                                }) %>
                            </span>
                        </div>
                    <% } %>
                </div>
            </div>
            
            <div class="card__footer border-t pt-6">
                <a href="<%= basePath %>auth/profile/edit" class="btn btn--primary w-full">
                    ‚úèÔ∏è Adatok szerkeszt√©se
                </a>
            </div>
        </div>

        <div class="card mb-6">
            <div class="card__header">
                <h2 class="card__title">‚öôÔ∏è Fi√≥k √°llapota</h2>
            </div>
            <div class="card__body">
                <div class="space-y-4">
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <span class="text-sm font-semibold text-gray-700">üîì Fi√≥k √°llapot:</span>
                        <span class="<%= user.isActive ? 'badge badge--success' : 'badge badge--danger' %>">
                            <%= user.isActive ? 'Akt√≠v' : 'Inakt√≠v' %>
                        </span>
                    </div>

                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <span class="text-sm font-semibold text-gray-700">‚úÖ Email meger≈ës√≠t√©s:</span>
                        <span class="<%= user.emailVerified ? 'badge badge--info' : 'badge badge--warning' %>">
                            <%= user.emailVerified ? 'Meger≈ës√≠tve' : 'F√ºgg≈ëben' %>
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card__header">
                <h2 class="card__title">üóëÔ∏è Fi√≥k t√∂rl√©se</h2>
            </div>
            <div class="card__body">
                <div class="alert alert--warning">
                    <div class="alert__icon">‚ö†Ô∏è</div>
                    <div class="alert__content">
                        <h4 class="alert__title">Figyelem!</h4>
                        <p class="alert__message">
                            A fi√≥k t√∂rl√©se v√©gleges √©s visszavonhatatlan m≈±velet. Az √∂sszes szem√©lyes adat v√©glegesen t√∂rl√©sre ker√ºl az adatb√°zisb√≥l.
                        </p>
                    </div>
                </div>
                
                <div x-data="{ showDeleteModal: false }" class="mt-4">
                    <button type="button" @click="showDeleteModal = true" class="btn btn--danger w-full">
                        üóëÔ∏è Fi√≥k v√©gleges t√∂rl√©se
                    </button>

                    <!-- Delete Confirmation Modal -->
                    <div x-show="showDeleteModal" 
                         x-transition:enter="transition ease-out duration-300"
                         x-transition:enter-start="opacity-0" 
                         x-transition:enter-end="opacity-100"
                         x-transition:leave="transition ease-in duration-200" 
                         x-transition:leave-start="opacity-100"
                         x-transition:leave-end="opacity-0" 
                         class="modal__backdrop" 
                         @click="showDeleteModal = false"
                         style="display: none;">

                        <div x-transition:enter="transition ease-out duration-300"
                             x-transition:enter-start="opacity-0 transform scale-90"
                             x-transition:enter-end="opacity-100 transform scale-100"
                             x-transition:leave="transition ease-in duration-200"
                             x-transition:leave-start="opacity-100 transform scale-100"
                             x-transition:leave-end="opacity-0 transform scale-90" 
                             class="modal modal--sm"
                             @click.stop>
                            <div class="modal__header">
                                <h3 class="modal__title">‚ö†Ô∏è Fi√≥k t√∂rl√©se</h3>
                            </div>
                            <div class="modal__body">
                                <p class="text-base text-gray-700">
                                    Biztosan t√∂r√∂lni szeretn√©d a fi√≥kodat? Ez a m≈±velet visszavonhatatlan!
                                </p>
                            </div>
                            <div class="modal__footer">
                                <button type="button" @click="showDeleteModal = false" class="btn btn--outline">
                                    M√©gse
                                </button>
                                <form method="POST" action="<%= basePath %>auth/delete-account" class="inline">
                                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                                    <button type="submit" class="btn btn--danger">
                                        T√∂rl√©s
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
