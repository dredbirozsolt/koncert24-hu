<!-- ==========================================================================
     1. HERO SECTION - Modern layout with image + info card
     ========================================================================== -->
<section class="performer-hero">
  <div class="performer-hero__container">
    
    <!-- Hero Image -->
    <div class="performer-hero__image-wrapper">
      <% if (performer.imageUrl) { %>
        <img src="<%= performer.imageUrl %>" 
             alt="<%= performer.name %> - <%= performer.categoryDisplayName || 'el≈ëad√≥' %>" 
             class="performer-hero__image"
             width="500"
             height="500">
      <% } else { %>
        <div class="performer__placeholder-image">
          <svg class="performer__placeholder-icon" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
          </svg>
        </div>
      <% } %>
      
      <!-- Status Badge on Image -->
      <% if (performer.status) { 
        let badgeClass = '';
        let badgeEmoji = '';
        if (performer.status === 'Kiemelt') {
          badgeClass = 'badge--featured';
          badgeEmoji = '‚≠ê';
        } else if (performer.status === 'N√©pszer≈±') {
          badgeClass = 'badge--popular';
          badgeEmoji = 'üî•';
        } else if (performer.status === 'Kedvezm√©nyes' || performer.status === 'Akci√≥s') {
          badgeClass = 'badge--discount';
          badgeEmoji = 'üí∞';
        }
      %>
        <span class="badge <%= badgeClass %> performer__status-badge">
          <%= badgeEmoji %> <%= performer.status %>
        </span>
      <% } %>
    </div>

    <!-- Hero Info Card -->
    <div class="performer-hero__info">
      <!-- Name -->
      <h1 class="performer-hero__name">
        <%= performer.name %>
      </h1>

      <!-- Style Tags -->
      <% if (performer.style && Array.isArray(performer.style) && performer.style.length > 0) { %>
        <div class="performer-hero__styles">
          <% performer.style.forEach(function(style) { %>
            <span class="performer-hero__style-tag"><%= style %></span>
          <% }); %>
        </div>
      <% } %>

      <!-- Performance Type -->
      <% if (performer.performanceType) { %>
        <span class="performer-hero__category">
          <%= performer.performanceType %>
        </span>
      <% } %>

      <!-- Pricing Section -->
      <div class="performer-hero__pricing">
        <% if (isLoggedIn && user && user.emailVerified) { %>
          <% if (performer.price) { %>
            <div class="performer-hero__price">
              <span class="performer-hero__price-label">Nett√≥ √°r:</span>
              <span class="performer-hero__price-value">
                <%= new Intl.NumberFormat('hu-HU').format(performer.price) %>
              </span>
              <span class="performer-hero__price-unit">Ft</span>
            </div>
          <% } %>
          <% if (performer.travelCost && performer.travelCost > 0) { %>
            <div class="text-sm text-secondary mt-2">
              + <%= new Intl.NumberFormat('hu-HU').format(performer.travelCost) %> Ft/km utaz√°si k√∂lts√©g
            </div>
          <% } %>
        <% } else { %>
          <div class="performer-hero__auth-notice">
            <% if (!isLoggedIn) { %>
              Az √°rak megtekint√©s√©hez 
              <a href="<%= basePath %>auth/login" class="performer-hero__auth-link">jelentkezzen be</a> 
              vagy 
              <a href="<%= basePath %>auth/register" class="performer-hero__auth-link">regisztr√°ljon</a>!
            <% } else if (!user.emailVerified) { %>
              Az √°rak megtekint√©s√©hez 
              <a href="<%= basePath %>auth/profile" class="performer-hero__auth-link">er≈ës√≠tse meg email c√≠m√©t</a>!
            <% } %>
          </div>
        <% } %>
      </div>

      <!-- CTA Buttons -->
      <div class="performer-hero__cta">
        <a href="<%= basePath %>ajanlat/<%= performer.slug %>?step=1" class="btn--hero-primary">
          <svg fill="currentColor" viewBox="0 0 20 20">
            <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"/>
            <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"/>
          </svg>
          Aj√°nlatot k√©rek
        </a>
        <a href="<%= basePath %>foglalas/<%= performer.slug %>?step=1" class="btn--hero-secondary">
          <svg fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
          </svg>
          Lefoglalom az el≈ëad√≥t
        </a>
      </div>
    </div>

  </div>
</section>

<!-- ==========================================================================
     2. QUICK FACTS BAR - Key information at a glance
     ========================================================================== -->
<section class="quick-facts">
  <div class="quick-facts__container">
    
    <!-- Duration -->
    <% if (performer.duration !== null && performer.duration !== undefined) { %>
      <div class="quick-facts__item">
        <div class="quick-facts__icon">
          <svg fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
          </svg>
        </div>
        <div class="quick-facts__content">
          <span class="quick-facts__label">Id≈ëtartam</span>
          <span class="quick-facts__value"><%= performer.duration %> perc</span>
        </div>
      </div>
    <% } %>

    <!-- Performance Type -->
    <% if (performer.performanceType) { %>
      <div class="quick-facts__item">
        <div class="quick-facts__icon">
          <svg fill="currentColor" viewBox="0 0 20 20">
            <path d="M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z"/>
          </svg>
        </div>
        <div class="quick-facts__content">
          <span class="quick-facts__label">T√≠pus</span>
          <span class="quick-facts__value"><%= performer.performanceType %></span>
        </div>
      </div>
    <% } %>

    <!-- Travel Cost -->
    <% if (performer.travelCost !== null && performer.travelCost !== undefined && performer.travelCost > 0) { %>
      <div class="quick-facts__item">
        <div class="quick-facts__icon">
          <svg fill="currentColor" viewBox="0 0 20 20">
            <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>
            <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1v-5a1 1 0 00-.293-.707l-2-2A1 1 0 0015 7h-1z"/>
          </svg>
        </div>
        <div class="quick-facts__content">
          <span class="quick-facts__label">Utaz√°s</span>
          <span class="quick-facts__value"><%= performer.travelCost %> Ft/km<% if (performer.travelCostCalculation) { %> (<%= performer.travelCostCalculation %>)<% } %></span>
        </div>
      </div>
    <% } %>

    <!-- Styles -->
    <% if (performer.style && Array.isArray(performer.style) && performer.style.length > 0) { %>
      <div class="quick-facts__item">
        <div class="quick-facts__icon">
          <svg fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
          </svg>
        </div>
        <div class="quick-facts__content">
          <span class="quick-facts__label">St√≠lus</span>
          <span class="quick-facts__value"><%= performer.style.slice(0, 2).join(', ') %><% if (performer.style.length > 2) { %> +<%= performer.style.length - 2 %><% } %></span>
        </div>
      </div>
    <% } %>

  </div>
</section>

<!-- ==========================================================================
     3. TAB NAVIGATION - Description, Details, Technical, Reviews
     ========================================================================== -->
<section class="tabs" x-data="{ activeTab: 'description' }">
  <div class="tabs__container">
    
    <!-- Tab Navigation -->
    <nav class="tabs__nav" role="tablist">
      <button class="tabs__button" 
              :class="{ 'active': activeTab === 'description' }"
              @click="activeTab = 'description'"
              role="tab"
              aria-selected="true">
        Le√≠r√°s
      </button>
      <button class="tabs__button"
              :class="{ 'active': activeTab === 'details' }"
              @click="activeTab = 'details'"
              role="tab">
        R√©szletek
      </button>
      <% if (performer.technicalRequirements) { %>
        <button class="tabs__button"
                :class="{ 'active': activeTab === 'technical' }"
                @click="activeTab = 'technical'"
                role="tab">
          Technikai k√∂vetelm√©nyek
        </button>
      <% } %>
      <button class="tabs__button"
              :class="{ 'active': activeTab === 'reviews' }"
              @click="activeTab = 'reviews'"
              role="tab">
        V√©lem√©nyek
      </button>
    </nav>

    <!-- Tab Content -->
    <div class="tabs__content">
      
      <!-- TAB 1: Description -->
      <div class="tabs__panel tab-description" 
           :class="{ 'active': activeTab === 'description' }"
           role="tabpanel"
           x-show="activeTab === 'description'">
        <h2>Az el≈ëad√≥r√≥l</h2>
        <div class="tab-description__content">
          <%= performer.description || 'Nincs le√≠r√°s.' %>
        </div>
      </div>

      <!-- TAB 2: Details -->
      <div class="tabs__panel tab-details" 
           :class="{ 'active': activeTab === 'details' }"
           role="tabpanel"
           x-show="activeTab === 'details'"
           x-cloak>
        <div class="tab-details__grid">
          
          <div class="tab-details__item">
            <span class="tab-details__label">Kateg√≥ria</span>
            <span class="tab-details__value"><%= categoryDisplayName %></span>
          </div>

          <% if (performer.performanceType) { %>
            <div class="tab-details__item">
              <span class="tab-details__label">El≈ëad√°s t√≠pusa</span>
              <span class="tab-details__value"><%= performer.performanceType %></span>
            </div>
          <% } %>

          <% if (performer.duration !== null && performer.duration !== undefined) { %>
            <div class="tab-details__item">
              <span class="tab-details__label">El≈ëad√°s hossza</span>
              <span class="tab-details__value"><%= performer.duration %> perc</span>
            </div>
          <% } %>

          <% if (isLoggedIn && user && user.emailVerified && performer.price) { %>
            <div class="tab-details__item">
              <span class="tab-details__label">Nett√≥ √°r</span>
              <span class="tab-details__value"><%= new Intl.NumberFormat('hu-HU').format(performer.price) %> Ft</span>
            </div>
          <% } %>

          <% if (performer.travelCost !== null && performer.travelCost !== undefined && performer.travelCost > 0) { %>
            <div class="tab-details__item">
              <span class="tab-details__label">Utaz√°si k√∂lts√©g</span>
              <span class="tab-details__value"><%= new Intl.NumberFormat('hu-HU').format(performer.travelCost) %> Ft/km</span>
            </div>
          <% } %>

          <% if (performer.travelCostCalculation) { %>
            <div class="tab-details__item">
              <span class="tab-details__label">Utaz√°s sz√°m√≠t√°sa</span>
              <span class="tab-details__value"><%= performer.travelCostCalculation %></span>
            </div>
          <% } %>

          <% if (performer.style && Array.isArray(performer.style) && performer.style.length > 0) { %>
            <div class="tab-details__item">
              <span class="tab-details__label">St√≠lus(ok)</span>
              <span class="tab-details__value"><%= performer.style.join(', ') %></span>
            </div>
          <% } %>

          <% if (performer.status) { %>
            <div class="tab-details__item">
              <span class="tab-details__label">St√°tusz</span>
              <span class="tab-details__value"><%= performer.status %></span>
            </div>
          <% } %>

        </div>
      </div>

      <!-- TAB 3: Technical Requirements -->
      <% if (performer.technicalRequirements) { %>
        <div class="tabs__panel tab-technical" 
             :class="{ 'active': activeTab === 'technical' }"
             role="tabpanel"
             x-show="activeTab === 'technical'"
             x-cloak>
          <h3>Technikai k√∂vetelm√©nyek</h3>
          <div class="tab-technical__content"><%= performer.technicalRequirements %></div>
          <div class="tab-technical__notice">
            <strong>Fontos:</strong> K√©rj√ºk, gondoskodjon r√≥la, hogy a helysz√≠n megfeleljen a fenti technikai k√∂vetelm√©nyeknek. K√©rd√©s eset√©n vegye fel vel√ºnk a kapcsolatot!
          </div>
        </div>
      <% } %>

      <!-- TAB 4: Reviews (placeholder) -->
      <div class="tabs__panel tab-reviews" 
           :class="{ 'active': activeTab === 'reviews' }"
           role="tabpanel"
           x-show="activeTab === 'reviews'"
           x-cloak>
        <div class="tab-reviews__empty">
          <svg class="tab-reviews__empty-icon" fill="currentColor" viewBox="0 0 20 20">
            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
          </svg>
          <p>Jelenleg nincs v√©lem√©ny ehhez az el≈ëad√≥hoz.</p>
          <p class="text-sm mt-2">Legy√©l Te az els≈ë, aki √©rt√©kel!</p>
        </div>
      </div>

    </div>

  </div>
</section>

<!-- ==========================================================================
     4. STICKY CTA - Mobile bottom bar (shows on scroll)
     ========================================================================== -->
<div class="sticky-cta" id="stickyCta">
  <div class="sticky-cta__container">
    <div class="sticky-cta__info">
      <h2 class="sticky-cta__name"><%= performer.name %></h2>
      <% if (isLoggedIn && user && user.emailVerified && performer.price) { %>
        <p class="sticky-cta__price">
          <%= new Intl.NumberFormat('hu-HU').format(performer.price) %> Ft
        </p>
      <% } %>
    </div>
    <a href="<%= basePath %>ajanlat/<%= performer.slug %>?step=1" class="sticky-cta__button">
      <svg fill="currentColor" viewBox="0 0 20 20">
        <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"/>
        <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"/>
      </svg>
      Aj√°nlatot k√©rek
    </a>
  </div>
</div>

<!-- ==========================================================================
     5. SIMILAR PERFORMERS SECTION
     ========================================================================== -->
<% if (relatedPerformers && relatedPerformers.length> 0) { %>
  <section class="similar-performers">
    <div class="container">
      <h2 class="similar-performers-title">Hasonl√≥ el≈ëad√≥k</h2>
      <div class="performers__grid">
        <% relatedPerformers.forEach(function(related) { %>
          <div class="performer__card">
            <div class="performer__image">
              <a href="/eloadok/<%= related.slug %>">
                <% if (related.imageUrl) { %>
                  <img src="<%= related.imageUrl %>" 
                       alt="<%= related.name %>" 
                       loading="lazy">
                  <% } else { %>
                    <div class="performer__placeholder">
                      <svg viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                          clip-rule="evenodd" />
                      </svg>
                    </div>
                    <% } %>
              </a>
              
              <!-- Status Badge on Image -->
              <% if (related.status) { 
                let badgeClass = '';
                let badgeEmoji = '';
                if (related.status === 'Kiemelt') {
                  badgeClass = 'badge--featured';
                  badgeEmoji = '‚≠ê';
                } else if (related.status === 'N√©pszer≈±') {
                  badgeClass = 'badge--popular';
                  badgeEmoji = 'üî•';
                } else if (related.status === 'Kedvezm√©nyes' || related.status === 'Akci√≥s') {
                  badgeClass = 'badge--discount';
                  badgeEmoji = 'üí∞';
                }
              %>
                <span class="badge <%= badgeClass %> performer__status-badge"><%= badgeEmoji %> <%= related.status %></span>
              <% } %>
            </div>
            <div class="performer__content">
              <div class="performer__header">
                <% if (related.performanceType) { %>
                  <div class="performer-category">
                    <%= related.performanceType %>
                  </div>
                <% } %>
                <% if (isLoggedIn && user && user.emailVerified && related.price) { %>
                  <div class="performer-price-badge">
                    <%= new Intl.NumberFormat('hu-HU').format(related.price) %> Ft-t√≥l
                  </div>
                  <% } %>
              </div>

              <h2 class="performer__name">
                <a href="/eloadok/<%= related.slug %>">
                  <%= related.name %>
                </a>
              </h2>

              <% if (related.shortDescription) { %>
                <p class="performer__description">
                  <%= related.shortDescription %>
                </p>
                <% } %>

              <% if (related.style && Array.isArray(related.style) && related.style.length > 0) { %>
                <div class="performer__styles">
                  <% related.style.forEach(function(style) { %>
                    <span class="badge badge--style"><%= style %></span>
                  <% }); %>
                </div>
              <% } %>

                  <div class="performer__actions">
                    <a href="/eloadok/<%= related.slug %>" class="btn btn--outline btn--pill">
                      <svg viewBox="0 0 20 20" fill="currentColor" class="btn-icon">
                        <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />
                        <path fill-rule="evenodd"
                          d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"
                          clip-rule="evenodd" />
                      </svg>
                      R√©szletek
                    </a>
                  </div>
            </div>
          </div>
          <% }); %>
      </div>
    </div>
  </section>

  <!-- Lazy Load Images Script for Related Performers -->
  <script>
    (function() {
      // Enhanced Lazy Load with Blur-up Effect for related performers
      const imageObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            
            // Add loaded class when image fully loads
            img.addEventListener('load', function() {
              img.classList.add('loaded');
            }, { once: true });
            
            // If image is already cached, add class immediately
            if (img.complete) {
              img.classList.add('loaded');
            }
            
            imageObserver.unobserve(img);
          }
        });
      }, {
        rootMargin: '50px',
        threshold: 0.01
      });
      
      // Observe all lazy images in related performers section
      document.querySelectorAll('.similar-performers .performer__image img[loading="lazy"]').forEach(img => {
        imageObserver.observe(img);
      });

      // ==========================================================================
      // STICKY CTA - Show/hide on scroll (mobile only)
      // ==========================================================================
      const stickyCta = document.getElementById('stickyCta');
      if (stickyCta && window.innerWidth < 768) {
        let lastScroll = 0;
        let ticking = false;

        window.addEventListener('scroll', function() {
          lastScroll = window.scrollY;

          if (!ticking) {
            window.requestAnimationFrame(function() {
              // Show sticky CTA after scrolling 300px down
              if (lastScroll > 300) {
                stickyCta.classList.add('visible');
              } else {
                stickyCta.classList.remove('visible');
              }
              ticking = false;
            });

            ticking = true;
          }
        });
      }
    })();
  </script>
<% } %>
